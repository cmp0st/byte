syntax = "proto3";

package files.v1;

option go_package = "github.com/cmp0st/byte/gen/files/v1;filesv1";

import "google/protobuf/timestamp.proto";
import "buf/validate/validate.proto";

// FileService provides filesystem operations
service FileService {
  // List directory contents
  rpc ListDirectory(ListDirectoryRequest) returns (ListDirectoryResponse);
  rpc MakeDirectory(MakeDirectoryRequest) returns (MakeDirectoryResponse);
}

// File information
message FileInfo {
  // File or directory name (basename)
  string name = 1;
  // Full path to the file or directory
  string path = 2;
  // Size of the file in bytes (0 for directories)
  int64 size = 3 [(buf.validate.field).int64.gte = 0];
  // Last modification time
  google.protobuf.Timestamp modified_time = 4;
  // Whether this is a directory
  bool is_dir = 5;
}

// List directory request
message ListDirectoryRequest {
  // Path to the directory to list
  string path = 1;
}

// List directory response
message ListDirectoryResponse {
  // Directory entries
  repeated FileInfo entries = 1;
}

message MakeDirectoryRequest {
  bool create_parents = 1;
  string path = 2 [(buf.validate.field).string.pattern = "[^\0]+"];
}

message MakeDirectoryResponse {}
